---
title: "Parameter Selection"
output:
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
    number_sections: true
---

```{r Setup, include = FALSE}

library(ggplot2)
library(dplyr)
library(lubridate)

# This is not running for me currently. I don't know if I am making
# some kind of error in setup, but there is something odd with it.
# 
# base_data_path = file.path(getwd(), "Project/scripts/data_io.R")
# source(base_data_path)

# Formatting data to read similar to lab
# Will change later.
cumulative_ad_data <- select(cumulative_ad_data, -SIZE, -REQUESTED_SIZES)

```


*Purpose:* This document splits up variables from the dataset and investigates relations between them.

First Pass: Initial selection of variables has mostly been done by grouping them logically or seeking intuitive relations between them. Major areas of interest to me are Price, Location and Device Type.


## Price

```{r Price}
summary(cumulative_ad_data$PRICE)
```


### Bid Wins

We can see from a t-test that there is a significant different in the mean prices between bids won and bids lost. A boxplot can show us the median prices for the bids, categorized by whether or not the bid won. We can see a clear distinction in the distribution of values between the two variables. The plot has been zoomed in for ease of reading.

```{r Price v. Bid Wins}
t.test(PRICE ~ BID_WON, data = cumulative_ad_data)


ggplot(cumulative_ad_data, aes(x = BID_WON, y = PRICE)) +
  geom_boxplot() +
  coord_cartesian(ylim = c(0, 2))
```



### Response Time

There are some very high values in the PRICE variable that pull values away from the overall shape. There could be a relation here as the increase in response time seems to lower the 

```{r Price v Response Time}
ggplot(cumulative_ad_data, aes(x = RESPONSE_TIME, y = PRICE)) +
  geom_point()


```

### Device Type

After reaching out to Andrew, he says that it should refer to a table he gave, but that the incrementor starts at 0. Meaning we can retrieve the Device Types by adding 1 and referring to the table. (Ex. DEVICE_TYPE = 0 -> DEVICE_TYPE = Mobile/Tablet (1 on the table) ).

This graph cuts off many outliers in the positive direction, but was done so to see the inner quartile range more clearly.

```{r Device Type v Price}

# Converting to factor for categorization
cumulative_ad_data$DEVICE_TYPE <- as.factor(cumulative_ad_data$DEVICE_TYPE) 

# Boxplot
cumulative_ad_data %>%
  ggplot(aes(x = DEVICE_TYPE, y = PRICE, fill = DEVICE_TYPE)) +
  geom_boxplot(outlier.size = 0.7) +
  coord_cartesian(ylim = c(0, 5)) +
  labs(
    title = "Price by Device Type",
    x = "Device Type",
    y = "Price"
  )


```

### Location
Price accross location would be a cool addition. I know a geo plot was made for the lab and could easily be included here for this section of investigation.


## Location

All of the variables we find relations to with location give opportunity do duplicate a pretty Oregon map similar to the plot Esther added in the Lab.


### Response Time
I feel Location and Response time could be related. The overall distances and the response of the service would play into this relation. I consider this interesting, but perhaps not high on the priority for overall beneficial information.

## Device Type

### Response Time

Potential for a relation of speed across devices. Some devices might be optimized differently, causing some bids to be slower? To make that claim, we would probably need to know more about the internet traffic during the bidding.

```{r Device Type v Response Time}
cumulative_ad_data %>%
  ggplot(aes(x = DEVICE_TYPE, y = RESPONSE_TIME, fill = DEVICE_TYPE)) + # Plotting the BoxPlot and labels
  geom_boxplot(outlier.size = 0.7) +
  labs(
    title = "Response Time by Device Type",
    x = "Device Type",
    y = "Response Time (ms)"
  )

```

### Location

This could be interesting to see if areas have differing device usage. Valuable if client wants to put more ads in specific areas and target more mobile or homebound users.

### Time
This could be a relation of heavier use on certain devices based on time of day.

```{r Device Type vs Time}
# Converting TIMESTAMP to a POSIXtc variable.
cumulative_ad_data$TIMESTAMP <- lubridate::parse_date_time(cumulative_ad_data$TIMESTAMP, c("ymd HMS", "mdy HMS"), tz = "UTC")


cumulative_ad_data$TIMEofDAY <- hour(cumulative_ad_data$TIMESTAMP)


# Lineplot of Device Type over Time
cumulative_ad_data %>%
  count(DEVICE_TYPE, TIMEofDAY) %>%
  ggplot(aes(x = TIMEofDAY, y = n, color = DEVICE_TYPE)) +
  geom_line(size = 1) +
  geom_point() +
  labs(
    x = "Hour of Day",
    y = "Useage",
    title = "Device Activity by Hour"
  ) +
  scale_x_continuous(breaks = 0:23)

```